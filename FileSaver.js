/**
 * 有道词典划词扩展 V3 - 可添加单词本，记录、导出查询历史！
 * @version v3.2.3
 * @link https://github.com/g8up/youDaoDict
 * @author g8up
 */
var saveAs=saveAs||function(t){"use strict";var e=t.document,r=function(){return t.URL||t.webkitURL||t},n=t.URL||t.webkitURL||t,o=e.createElementNS("http://www.w3.org/1999/xhtml","a"),i="download"in o,a=function(r){var n=e.createEvent("MouseEvents");return n.initMouseEvent("click",!0,!1,t,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(n)},c=t.webkitRequestFileSystem,u=t.requestFileSystem||c||t.mozRequestFileSystem,s=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},f="application/octet-stream",l=0,d=[],v=function(){for(var t=d.length;t--;){var e=d[t];"string"==typeof e?n.revokeObjectURL(e):e.remove()}d.length=0},w=function(t,e,r){e=[].concat(e);for(var n=e.length;n--;){var o=t["on"+e[n]];if("function"==typeof o)try{o.call(t,r||t)}catch(i){s(i)}}},p=function(e,n){var s,v,p,y=this,h=e.type,R=!1,E=function(t){var e=r().createObjectURL(t);return d.push(e),e},m=function(){w(y,"writestart progress write writeend".split(" "))},N=function(){!R&&s||(s=E(e)),v.location.href=s,y.readyState=y.DONE,m()},S=function(t){return function(){if(y.readyState!==y.DONE)return t.apply(this,arguments)}},O={create:!0,exclusive:!1};return y.readyState=y.INIT,n||(n="download"),i&&(s=E(e),o.href=s,o.download=n,a(o))?(y.readyState=y.DONE,void m()):(t.chrome&&h&&h!==f&&(p=e.slice||e.webkitSlice,e=p.call(e,0,e.size,f),R=!0),v=h===f||c?t:t.open(),u?(l+=e.size,void u(t.TEMPORARY,l,S(function(t){t.root.getDirectory("saved",O,S(function(t){var r=function(){t.getFile(n,O,S(function(t){t.createWriter(S(function(r){r.onwriteend=function(e){v.location.href=t.toURL(),d.push(t),y.readyState=y.DONE,w(y,"writeend",e)},r.onerror=function(){var t=r.error;t.code!==t.ABORT_ERR&&N()},"writestart progress write abort".split(" ").forEach(function(t){r["on"+t]=y["on"+t]}),r.write(e),y.abort=function(){r.abort(),y.readyState=y.DONE},y.readyState=y.WRITING}),N)}),N)};t.getFile(n,{create:!1},S(function(t){t.remove(),r()}),S(function(t){t.code===t.NOT_FOUND_ERR?r():N()}))}),N)}),N)):void N())},y=p.prototype,h=function(t,e){return new p(t,e)};return y.abort=function(){var t=this;t.readyState=t.DONE,w(t,"abort")},y.readyState=y.INIT=0,y.WRITING=1,y.DONE=2,y.error=y.onwritestart=y.onprogress=y.onwrite=y.onabort=y.onerror=y.onwriteend=null,t.addEventListener("unload",v,!1),h}(self);